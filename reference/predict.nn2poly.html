<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Predicted values obtained with a nn2poly object on given data."><title>Predict method for nn2poly objects. — predict.nn2poly • nn2poly</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predict method for nn2poly objects. — predict.nn2poly"><meta property="og:description" content="Predicted values obtained with a nn2poly object on given data."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">nn2poly</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/nn2poly-01-introduction.html">Introduction to nn2poly</a>
    <a class="dropdown-item" href="../articles/nn2poly-02-supported-DL-frameworks.html">Supported DL frameworks</a>
    <a class="dropdown-item" href="../articles/nn2poly-03-classification-example.html">Classification example using tensorflow</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Predict method for <code>nn2poly</code> objects.</h1>
      
      <div class="d-none name"><code>predict.nn2poly.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Predicted values obtained with a nn2poly object on given data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for nn2poly</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">newdata</span>, layers <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>Object of class inheriting from 'nn2poly'.</p></dd>


<dt>newdata</dt>
<dd><p>Input data as matrix, vector or dataframe.
Number of columns (or elements in vector) should be the number of variables
in the polynomial (dimension p). Response variable to be predicted should
not be included.</p></dd>


<dt>layers</dt>
<dd><p>Vector containing the chosen layers from <code>object</code> to be
evaluated. If set to <code>NULL</code>, all layers are computed. Default is set
to <code>NULL</code>.</p></dd>


<dt>...</dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Returns a matrix or list of matrices with the evaluation of each
polynomial at each layer as given by the provided <code>object</code> of class
<code>nn2poly</code>.</p>


<p>If <code>object</code> contains the polynomials of the last layer, as given by
<code>nn2poly(object, keep_layers = FALSE)</code>, then the output is a matrix with
the evaluation of each data point on each polynomial. In this matrix, each
column represents the evaluation of a polynomial and each column corresponds
to each point in the new data to be evaluated.</p>


<p>If <code>object</code> contains all the internal polynomials also, as given by
<code>nn2poly(object, keep_layers = TRUE)</code>, then the output is a list of
layers (represented by <code>layer_i</code>), where each one is another list with
<code>input</code> and <code>output</code> elements, where each one contains a matrix
with the evaluation of the "input" or "output" polynomial at the given layer,
as explained in the case without internal polynomials.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Internally uses <code><a href="eval_poly.html">eval_poly()</a></code> to obtain the predictions. However, this only
works with a objects of class <code>nn2poly</code> while <code><a href="eval_poly.html">eval_poly()</a></code> can be used
with a manually created polynomial in list form.</p>
<p>When <code>object</code> contains all the internal polynomials also, as given by
<code>nn2poly(object, keep_layers = TRUE)</code>, it is important to note that there
are two polynomial items per layer (input/output). These polynomial items will
also contain several polynomials of the same structure, one per neuron in the
layer, stored as matrix rows in <code>$values</code>. Please see the NN2Poly
original paper for more details.</p>
<p>Note also that "linear" layers will contain the same input and output results
as Taylor expansion is not used and thus the polynomials are also the same.
Because of this, in the situation of evaluating multiple layers we provide
the final layer with "input" and "output" even if they are the same, for
consistency.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="nn2poly.html">nn2poly()</a></code>: function that obtains the <code>nn2poly</code> polynomial
object, <code><a href="eval_poly.html">eval_poly()</a></code>: function that can evaluate polynomials in general,
<code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">stats::predict()</a></code>: generic predict function.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Build a NN structure with random weights, with 2 (+ bias) inputs,</span></span></span>
<span class="r-in"><span><span class="co"># 4 (+bias) neurons in the first hidden layer with "tanh" activation</span></span></span>
<span class="r-in"><span><span class="co"># function, 4 (+bias) neurons in the second hidden layer with "softplus",</span></span></span>
<span class="r-in"><span><span class="co"># and 1 "linear" output unit</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">weights_layer_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weights_layer_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">weights_layer_3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set it as a list with activation functions as names</span></span></span>
<span class="r-in"><span><span class="va">nn_object</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"tanh"</span> <span class="op">=</span> <span class="va">weights_layer_1</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"softplus"</span> <span class="op">=</span> <span class="va">weights_layer_2</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"linear"</span> <span class="op">=</span> <span class="va">weights_layer_3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Obtain the polynomial representation (order = 3) of that neural network</span></span></span>
<span class="r-in"><span><span class="va">final_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="nn2poly.html">nn2poly</a></span><span class="op">(</span><span class="va">nn_object</span>, max_order <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define some new data, it can be vector, matrix or dataframe</span></span></span>
<span class="r-in"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict using the obtained polynomial</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">final_poly</span>, newdata <span class="op">=</span> <span class="va">newdata</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 154497677655    200445286  10259082512    648850668  -6622114287</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Change the last layer to have 3 outputs (as in a multiclass classification)</span></span></span>
<span class="r-in"><span><span class="co"># problem</span></span></span>
<span class="r-in"><span><span class="va">weights_layer_4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">5</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Set it as a list with activation functions as names</span></span></span>
<span class="r-in"><span><span class="va">nn_object</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"tanh"</span> <span class="op">=</span> <span class="va">weights_layer_1</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"softplus"</span> <span class="op">=</span> <span class="va">weights_layer_2</span>,</span></span>
<span class="r-in"><span>                 <span class="st">"linear"</span> <span class="op">=</span> <span class="va">weights_layer_4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Obtain the polynomial representation of that neural network</span></span></span>
<span class="r-in"><span><span class="co"># Polynomial representation of each hidden neuron is given by</span></span></span>
<span class="r-in"><span><span class="va">final_poly</span> <span class="op">&lt;-</span> <span class="fu"><a href="nn2poly.html">nn2poly</a></span><span class="op">(</span><span class="va">nn_object</span>, max_order <span class="op">=</span> <span class="fl">3</span>, keep_layers <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define some new data, it can be vector, matrix or dataframe</span></span></span>
<span class="r-in"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict using the obtained polynomials (for all layers)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">final_poly</span>, newdata <span class="op">=</span> <span class="va">newdata</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_1$input</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]     [,2]        [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.5339738 2.901525 -0.31466300 -0.2542238</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] -1.8861745 1.646391  0.88667321 -0.3905338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]  0.9186361 5.087257 -1.96586601  0.2533629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -0.4603238 1.114381  0.41905625 -1.0470477</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -1.5735951 3.463157 -0.04853725  0.2993833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_1$output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]       [,2]        [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] -0.53158506   -72.6299 -0.30587352 -0.2476813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]  0.21054968    31.6654  0.66787464 -0.3805885</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -2.61504595 -2286.7737  0.37037773  0.3814392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] -1.43140592   163.7199  0.43262353 -0.7588698</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] -0.06102861  -271.0512 -0.06460641  0.3160078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_2$input</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]      [,2]       [,3]        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -58.58033  27.96176   40.16512   -34.66948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    28.36224 -13.49444  -16.50852    14.33548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1887.65876 870.96099 1273.72386 -1136.53410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   136.50138 -63.74116  -92.96963    83.08216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -222.14986 103.59979  151.65180  -134.85484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_2$output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]         [,2]        [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -188526631    -495025.4    -9194290   -2670784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   1895761173    4925743.5    91079578   27196885</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -44911813022 -115584161.7 -2155216415 -647790945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   8092954815   20040456.2   380656400  121560619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -2718157487   -6720729.4  -128236249  -40843813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_3$input</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]         [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -3995903    27795378   -188917498   -139676500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   38297290  -279384239   1901248955   1403971229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -905300430  6621792382 -45048275035 -33260285927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  153809736 -1195921890   8128920452   5990438126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -52238799   401830488  -2729911865  -2012161409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_3$output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]         [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -3995903    27795378   -188917498   -139676500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   38297290  -279384239   1901248955   1403971229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -905300430  6621792382 -45048275035 -33260285927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  153809736 -1195921890   8128920452   5990438126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -52238799   401830488  -2729911865  -2012161409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict using the obtained polynomials (for chosen layers)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">final_poly</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, layers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_2$input</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]      [,2]       [,3]        [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -58.58033  27.96176   40.16512   -34.66948</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    28.36224 -13.49444  -16.50852    14.33548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -1887.65876 870.96099 1273.72386 -1136.53410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   136.50138 -63.74116  -92.96963    83.08216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -222.14986 103.59979  151.65180  -134.85484</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_2$output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              [,1]         [,2]        [,3]       [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -188526631    -495025.4    -9194290   -2670784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   1895761173    4925743.5    91079578   27196885</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -44911813022 -115584161.7 -2155216415 -647790945</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]   8092954815   20040456.2   380656400  121560619</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -2718157487   -6720729.4  -128236249  -40843813</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_3$input</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]         [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -3995903    27795378   -188917498   -139676500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   38297290  -279384239   1901248955   1403971229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -905300430  6621792382 -45048275035 -33260285927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  153809736 -1195921890   8128920452   5990438126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -52238799   401830488  -2729911865  -2012161409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $layer_3$output</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]        [,2]         [,3]         [,4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]   -3995903    27795378   -188917498   -139676500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]   38297290  -279384239   1901248955   1403971229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] -905300430  6621792382 -45048275035 -33260285927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,]  153809736 -1195921890   8128920452   5990438126</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,]  -52238799   401830488  -2729911865  -2012161409</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pablo Morala, Iñaki Ucar.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

